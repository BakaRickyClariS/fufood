name: Frontend Release Announcement

on:
  push:
    branches:
      - main
      - qa # æ–°å¢å° qa åˆ†æ”¯çš„ç›£è½

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Send Release Notification
        run: |
          # æ ¹æ“šæ¨é€çš„åˆ†æ”¯æ±ºå®šé¡¯ç¤ºçš„ç’°å¢ƒåç¨±
          ENVIRONMENT="æ­£å¼ç‰ˆ"
          if [[ "${{ github.ref }}" == "refs/heads/qa" ]]; then
            ENVIRONMENT="æ¸¬è©¦ç‰ˆ (QA)"
          fi

          curl -X POST "https://gemini-ai-recipe-gen-mvp.vercel.app/api/v1/admin/announcements/release" \
          -H "Content-Type: application/json" \
          -H "X-Deploy-Secret: ${{ secrets.DEPLOY_SECRET }}" \
          -d "{
            \"version\": \"FE-${{ github.sha }}\",
            \"releaseNotes\": \"ğŸš€ $ENVIRONMENT æ›´æ–°ï¼š${{ github.event.head_commit.message }}\",
            \"forceUpdate\": false
          }"
